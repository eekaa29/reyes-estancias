{% extends 'core/base.html' %}
{% load static %}
{% block head_extra  %}
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
  <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/es.js"></script>
{% endblock  %}

{% block title %}Reyes Estancias — Home{% endblock %}

{# Navbar encima de la imagen #}
{% block nav_position %}absolute inset-x-0 top-0 z-50{% endblock %}
{% block nav_colors %}bg-transparent text-white{% endblock %}
{% block menu_btn_variant %}text-white {% endblock %}

{% block content %}
  <!-- HERO con imagen de fondo -->
  <section class="relative min-h-[100svh] sm:min-h-[480px] grid">
    <img src="{% static 'core/img/foto-home.jpg' %}"
         alt="Hero"
         class="absolute inset-0 w-full h-full object-cover">
    <!-- Oscurecedor para legibilidad -->
    <div class="absolute inset-0 bg-black/35"></div>

    <!-- Texto del hero -->
    <div class="relative z-10 self-end px-4 pb-10 pt-16 sm:pt-24">
        <h1 class=" font-bold uppercase text-white tracking-[-0.04em] p-2 text-4xl md:text-6xl lg:text-7xl">COMPRUEBA DISPONIBILIDAD</h1>
        <form action="{% url 'home' %}" method="post" class="grid grid-cols-1 sm:grid-cols-4 gap-3 bg-white/90 p-4 rounded-2xl backdrop-blur md:col-start-1">
            {% csrf_token %}
            <div class="">
                {{ form.checkin }}
            </div>
            <div class="class">
                {{ form.checkout }}
            </div>
            <div class="class">
                {{ form.cant_personas }}
            </div>
            <div class="flex justify-end">
                <button class="inline-flex items-center rounded-xl bg-black px-5 py-2 font-medium text-white hover:opacity-90">Buscar</button>
            </div>
        </form>
        <div class="flex items-center w-full pt-8">
          <p class="text-white">Al reservar estoy aceptando los <a class="italic underline" href="{% url 'terminos_y_condiciones' %}">Términos y Condiciones de la empresa</a></p>
          <div class=" w-full flex justify-end">
            <p class="uppercase font-bold tracking-[0.06em] flex justify-end text-white">(DESLIZA)</p>
          </div>
          
        </div>
    </div>  
    
  </section>
  <section class="px-4 py-24 bg-slate-100">
    <div class="flex flex-col">
      <h2 class=" flex justify-start text-black font-bold text-4xl md:text-6xl lg:text-7xl md:max-w-16 pb-3 tracking-[-0.04em]">HOSPEDAJE DE REYES</h2>
      <p class="flex justify-end uppercase font-semibold text-base tracking-[-0.04em] ">(SOBRE NOSOTROS)</p>
    </div>
    <div class="mx-auto max-w-7xl px-4 flex flex-col items-center justify-center p-4">
      <img src="{% static 'core/img/foto-playa-home.jpg' %}" alt="" class="w-full md:max-w-[40%]">
      <p class="mt-3 text-black font-medium text-md md:text-xl max-w-[60%] md:max-w-[40%] tracking-[-0.04em]">Nuestro compromiso de hospedar a personas comenzo con 
        nuestro padre cuando decidió invertir el dinero que generaba vendiendo frutas y 
        verduras en un terreno y construyendo una bodega de almacenamiento, el tiempo fue 
        pasando y con él la evolución de las bodegas pasaron de ser 1 a 3.
      </p>
      <p class="mt-3 text-black font-medium text-ml md:text-xl max-w-[60%] md:max-w-[40%] tracking-[-0.04em] pt-2">
        Posteriormente 
        inició construyendo apartamentos encima de ellos, con el paso de los años fue aumentando 
        el número de apartamentos y de casas. Muchas cosas cambiaron desde aquellos años, pero lo que nunca cambiará es
        el compromiso familiar y de trabajadores para ofrecer el mejor servicio y que nuestros clientes se sientan como en casa.
      </p>
      <p class="m-0 text-xl sm:text-2xl font-semibold tracking-tight mt-6">
        <a href="{% url 'property_list' %}" class="group inline-block align-top">
          <!-- Clip de 1 línea -->
          <span class="relative block overflow-hidden h-[1em] leading-[1]">
            <!-- Cinta de 2 líneas; al hover sube 1 línea -->
            <span class="block transform-gpu transition-transform duration-300 ease-[cubic-bezier(.2,.7,0,1)]
                        group-hover:-translate-y-1/2">
              <span class="block italic">VER PROPIEDADES</span>
              <span class="block" aria-hidden="true">VER PROPIEDADES</span>
            </span>
          </span>
        </a>
      </p>
    </div>
  </section>
{% endblock %}
{% block body_extra %}
    <script>
    // Utilidades de fecha
    const addDays = (d, n) => {
        const x = new Date(d.getFullYear(), d.getMonth(), d.getDate());
        x.setDate(x.getDate() + n);
        return x;
    };
    const fmt = d => d.toISOString().slice(0,10); // YYYY-MM-DD

    const $in  = document.getElementById("id_checkin");
    const $out = document.getElementById("id_checkout");

    // Flatpickr en español
    const fpIn = flatpickr($in, {
        dateFormat: "Y-m-d",
        minDate: "today",
        locale: "es",
        onChange: function(selectedDates) {
        if (!selectedDates.length) return;
        const checkin = selectedDates[0];
        const minOut = addDays(checkin, 2); // mínimo 2 noches
        fpOut.set("minDate", minOut);

        // Si checkout vacío o menor que minOut, lo auto-ajustamos
        const currentOut = fpOut.selectedDates[0];
        if (!currentOut || currentOut < minOut) {
            fpOut.setDate(minOut, true); // true = dispara onChange
        }
        },
    });

    const fpOut = flatpickr($out, {
        dateFormat: "Y-m-d",
        minDate: "today",
        locale: "es",
    });
    </script>
{% endblock %}
