{% extends 'core/base.html' %}
{% load static %}
{% block head_extra  %}
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
  <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/es.js"></script>
{% endblock  %}

{% block title %}Reyes Estancias — Home{% endblock %}

{# Navbar encima de la imagen #}
{% block nav_position %}absolute inset-x-0 top-0 z-50{% endblock %}
{% block nav_colors %}bg-transparent text-white{% endblock %}
{% block menu_btn_variant %}bg-white/10 text-white ring-1 ring-white/60 backdrop-blur hover:bg-white/20{% endblock %}

{% block content %}
  <!-- HERO con imagen de fondo -->
  <section class="relative h-[100vh] min-h-[480px]">
    <img src="{% static 'core/img/foto-home.jpg' %}"
         alt="Hero"
         class="absolute inset-0 w-full h-full object-cover">
    <!-- Oscurecedor para legibilidad -->
    <div class="absolute inset-0 bg-black/35"></div>

    <!-- Texto del hero -->
    <div class="relative z-10 h-full max-w-5xl px-4 flex flex-col items-start justify-end pb-10">
        <h1 class=" font-bold uppercase text-white tracking-[-0.04em] p-2 text-7xl">COMPRUEBA DISPONIBILIDAD</h1>
        <form action="{% url 'home' %}" method="post" class="grid grid-cols-1 sm:grid-cols-4 gap-3 bg-white/90 p-4 rounded-2xl backdrop-blur md:col-start-1">
            {% csrf_token %}
            <div class="">
                {{ form.checkin }}
            </div>
            <div class="class">
                {{ form.checkout }}
            </div>
            <div class="class">
                {{ form.cant_personas }}
            </div>
            <div class="flex justify-end">
                <button class="inline-flex items-center rounded-xl bg-black px-5 py-2 font-medium text-white hover:opacity-90">Buscar</button>
            </div>
        </form>
        <p class="text-white pt-3">Al reservar estoy aceptando los <a class="italic underline" href="{% url 'terminos_y_condiciones' %}">Términos y Condiciones de la empresa</a></p>
    </div>  
    
  </section>
  <section class="px-4 py-24">
    <div class="flex flex-col">
      <h2 class=" flex justify-start text-black font-bold text-7xl md:text-9xl md:max-w-16 pb-3 tracking-[-0.04em]">HOSPEDAJE DE REYES</h2>
      <p class="flex justify-end uppercase font-semibold text-base tracking-[-0.04em] ">(SOBRE NOSOTROS)</p>
    </div>
    <div class="mx-auto max-w-7xl px-4 flex flex-col items-center justify-center p-4">
      <img src="{% static 'core/img/foto-playa-home.jpg' %}" alt="" class="w-full md:max-w-[40%]">
      <p class="mt-3 text-black font-medium text-xl max-w-[60%] md:max-w-[40%] tracking-[-0.04em]">Nuestro compromiso de hospedar a personas comenzo con 
        nuestro padre cuando decidió invertir el dinero que generaba vendiendo frutas y 
        verduras en un terreno y construyendo una bodega de almacenamiento, el tiempo fue 
        pasando y con él la evolución de las bodegas pasaron de ser 1 a 3.
      </p>
      <p class="mt-3 text-black font-medium text-xl max-w-[60%] md:max-w-[40%] tracking-[-0.04em] pt-2">
        Posteriormente 
        inicií construyendo apartamentos encima de ellos, con el paso de los años fue aumentando 
        el número de apartamentos y de casas. Muchas cosas cambiaron desde aquellos años, pero lo que nunca cambiará es
        el compromiso familiar y de trabajadores para ofrecer el mejor servicio y que nuestros clientes se sientan como en casa.
      </p>
      <a href="{% url 'property_list' %}" class=" mt-5 inline-flex items-center rounded-xl bg-black px-5 py-2 font-medium text-white hover:opacity-90">VER PROPIEDADES</a>
    </div>
  </section>
  {% comment %} <section class="relative h-[100vh] min-h-[480px]">
    <div>
        <h1>POPIEDADES ÚNICAS</h1>
        
    </div>
  </section> {% endcomment %}
{% endblock %}
{% block body_extra %}
    <script>
    // Utilidades de fecha
    const addDays = (d, n) => {
        const x = new Date(d.getFullYear(), d.getMonth(), d.getDate());
        x.setDate(x.getDate() + n);
        return x;
    };
    const fmt = d => d.toISOString().slice(0,10); // YYYY-MM-DD

    const $in  = document.getElementById("id_checkin");
    const $out = document.getElementById("id_checkout");

    // Flatpickr en español
    const fpIn = flatpickr($in, {
        dateFormat: "Y-m-d",
        minDate: "today",
        locale: "es",
        onChange: function(selectedDates) {
        if (!selectedDates.length) return;
        const checkin = selectedDates[0];
        const minOut = addDays(checkin, 2); // mínimo 2 noches
        fpOut.set("minDate", minOut);

        // Si checkout vacío o menor que minOut, lo auto-ajustamos
        const currentOut = fpOut.selectedDates[0];
        if (!currentOut || currentOut < minOut) {
            fpOut.setDate(minOut, true); // true = dispara onChange
        }
        },
    });

    const fpOut = flatpickr($out, {
        dateFormat: "Y-m-d",
        minDate: "today",
        locale: "es",
    });
    </script>
{% endblock %}
