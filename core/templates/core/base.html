{% load static tailwind_tags %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{% block title %} Reyes Estancias {% endblock %}</title>
    {% load static %} {% tailwind_css %}
    {% block head_extra  %}{% endblock  %}
  </head>
  <body>
    <header class="{% block nav_position %}{% endblock %}">
      <nav
        class="relative mx-auto max-w-7xl px-4 py-4 flex items-center justify-between
              {% block nav_colors %}bg-white text-slate-900{% endblock %}">
        <a href="{% url 'home' %}">
          <h1 class="text-3xl sm:text-4xl font-semibold tracking-tight">Reyes Estancias</h1>
        </a>

        <!-- Botón MENÚ -->
        <button id="menu-btn" type="button"
          class="uppercase font-bold tracking-wide px-4 py-2 rounded-full
                {% block menu_btn_variant %}bg-black text-white{% endblock %}"
          aria-haspopup="true" aria-expanded="false" aria-controls="menu-panel">
          Menú
        </button>

        <!-- Panel desplegable -->
        <div id="menu-panel"
            class="hidden absolute right-0 top-full mt-2 w-60 rounded-xl bg-white shadow-lg
                    ring-1 ring-slate-200 p-2 z-50">
          <ul class="space-y-1 text-sm font-medium text-slate-800">
            <li><a class="block px-3 py-2 rounded-lg hover:bg-slate-100" href="{% url 'property_list' %}">Propiedades</a></li>
            <li><a class="block px-3 py-2 rounded-lg hover:bg-slate-100" href="{% url 'about_us' %}">Sobre Nosotros</a></li>
            <li><a class="block px-3 py-2 rounded-lg hover:bg-slate-100" href="{% url 'bookings_list' %}">Mis Reservas</a></li>

            {% if not request.user.is_authenticated %}
              <li><a class="block px-3 py-2 rounded-lg hover:bg-slate-100" href="{% url 'login' %}">Iniciar Sesión</a></li>
            {% else %}
              <li>
                <form id="logout-form" method="post" action="{% url 'admin:logout' %}">
                  {% csrf_token %}
                  <button type="submit" class="w-full text-left block px-3 py-2 rounded-lg hover:bg-slate-100">
                    Cerrar sesión
                  </button>
                </form>
              </li>
            {% endif %}

            {% if request.user.is_staff %}
              <li><a class="block px-3 py-2 rounded-lg hover:bg-slate-100" href="{% url 'admin:index' %}">Panel de Control</a></li>
            {% endif %}
          </ul>
        </div>
      </nav>
    </header>

    {% comment %} {% if messages %}
    <div class="fixed top-4 right-4 space-y-2 z-50">
      {% for message in messages %}
      <div
        class="px-4 py-3 rounded-lg shadow text-sm transition {% if message.tags == 'success' %}bg-green-100 text-green-800 {% elif message.tags == 'error' %}bg-red-100 text-red-800 {% elif message.tags == 'warning' %}bg-yellow-100 text-yellow-800 {% else %}bg-blue-100 text-blue-800{% endif %}"
        role="status"
        data-toast
      >
        {{ message }}
      </div>
      {% endfor %}
    </div>
    {% endif %}  {% endcomment %}
    {% block content %}{% endblock %}
    {% block body_extra %}{% endblock  %}
    <script>
      // Toggle menú
      const btn = document.getElementById('menu-btn');
      const panel = document.getElementById('menu-panel');

      btn.addEventListener('click', () => {
        const wasHidden = panel.classList.toggle('hidden'); // toggle devuelve true si ahora tiene la clase
        const isOpen = !wasHidden;
        btn.setAttribute('aria-expanded', String(isOpen));
      });

      // Cerrar al click fuera
      document.addEventListener('click', (e) => {
        if (!panel.contains(e.target) && !btn.contains(e.target)) {
          if (!panel.classList.contains('hidden')) {
            panel.classList.add('hidden');
            btn.setAttribute('aria-expanded', 'false');
          }
        }
      });

      // Cerrar con ESC
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
          panel.classList.add('hidden');
          btn.setAttribute('aria-expanded', 'false');
        }
      });
    </script>
  </body>
  <hr class="border-gray-300 border-0.1">
  <footer class="grid grid-cols-2 m-3">
    <div class="font-bold uppercase tracking-[-0.04em]">
      <p>CONTACTO</p>
      <p>+52 3314494215</p>
      <p>+34 672921265</p>
      <a href="mailto:Reyesestancias@gmail.com">Reyesestancias@gmail.com</a>
    </div>
    <div class="flex justify-end items-center">
      <a href="{% url 'terminos_y_condiciones' %}" class="font-bold uppercase tracking-[-0.04em]">TERMINOS Y CONDICIONES</a>
    </div>
  </footer>
</html>
